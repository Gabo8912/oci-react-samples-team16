# pentest_zap.ps1
$TARGET_URL = "http://160.34.212.189"
$TIMESTAMP = Get-Date -Format "yyyyMMdd_HHmmss"
$REPORT_FILE = "zap_results_${TIMESTAMP}.xml"

Write-Host "Pulling OWASP ZAP Docker image..."
docker pull ghcr.io/zaproxy/zaproxy:stable

Write-Host "Starting ZAP scan against ${TARGET_URL}..."
docker run -v ${PWD}:/zap/wrk/:rw -t ghcr.io/zaproxy/zaproxy:stable zap.sh -cmd `
  -quickurl ${TARGET_URL} `
  -quickout /zap/wrk/${REPORT_FILE}

if (Test-Path $REPORT_FILE) {
    Write-Host "Scan completed successfully. Report generated: ${REPORT_FILE}"
} else {
    Write-Host "Scan failed or report was not generated."
    exit 1
}